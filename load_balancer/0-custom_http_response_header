#!/usr/bin/env bash
# Configure Nginx to add a custom HTTP response header X-Served-By with the server hostname

# Update and install nginx
apt-get update -y
apt-get install nginx -y

# Get the hostname
HOSTNAME=$(hostname)

# Backup original config
cp /etc/nginx/nginx.conf /etc/nginx/nginx.conf.backup

# Add custom header to nginx http block
sed -i "/http {/a \    add_header X-Served-By $HOSTNAME;" /etc/nginx/nginx.conf

# Ensure nginx is configured to serve
mkdir -p /var/www/html
echo "Holberton School" > /var/www/html/index.html

# Restart nginx without systemctl
service nginx restart
